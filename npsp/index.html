<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NPSP Architecture Explorer</title>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HJTE1NYP82"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HJTE1NYP82');
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/galaxy.css">
</head>
<body>

<!-- Canvas layers: starfield (z0) > force graph (z1) > particles (z2) -->
<canvas id="starfield"></canvas>
<canvas id="graph-canvas"></canvas>
<canvas id="particle-canvas"></canvas>

<!-- Search Overlay -->
<div id="search-overlay" role="dialog" aria-label="Search NPSP architecture">
  <div class="search-container">
    <div class="search-input-wrap">
      <span class="search-icon" aria-hidden="true">&#x1F50D;</span>
      <input type="text" id="searchInput" placeholder="Search triggers, classes, objects, concepts..." autocomplete="off" spellcheck="false" aria-label="Search NPSP architecture">
      <div class="search-nav" id="searchNav" style="display:none">
        <span class="search-count" id="searchCount" aria-live="polite">0/0</span>
        <button class="search-nav-btn" onclick="cycleResult(-1)" title="Previous (Shift+Enter)" aria-label="Previous result">&#x25B2;</button>
        <button class="search-nav-btn" onclick="cycleResult(1)" title="Next (Enter)" aria-label="Next result">&#x25BC;</button>
      </div>
      <button class="search-close" onclick="closeSearch()" aria-label="Close search">ESC</button>
    </div>
    <div class="search-results" id="searchResults" role="listbox" aria-label="Search results"></div>
    <div class="search-hint">
      <kbd>Enter</kbd> next result &middot; <kbd>Shift+Enter</kbd> previous &middot; <kbd>ESC</kbd> close &middot; Click to navigate
    </div>
  </div>
</div>

<!-- Navbar -->
<nav id="navbar" aria-label="Navigation">
  <div id="breadcrumb" aria-label="Breadcrumb navigation">
    <span class="crumb active" data-level="galaxy">NPSP</span>
  </div>
  <div class="nav-actions">
    <button class="search-btn" onclick="openSearch()" aria-label="Open search">
      &#x1F50D; <span>Search</span> <kbd>/</kbd>
    </button>
    <div id="zoom-indicator" aria-hidden="true">
      <span style="font-size:10px;margin-right:4px">ZOOM</span>
      <div class="zoom-dot active" data-z="1"></div>
      <div class="zoom-dot" data-z="2"></div>
      <div class="zoom-dot" data-z="3"></div>
    </div>
  </div>
</nav>

<!-- Back button -->
<button class="back-btn" id="backBtn" onclick="goBack()" aria-label="Go back"><span>&larr;</span> Back</button>

<!-- Stage -->
<div id="stage">
  <!-- GALAXY VIEW (canvas-based, minimal DOM) -->
  <div id="galaxy-view" class="view-layer active">
    <div class="galaxy-title">
      <h1>NONPROFIT SUCCESS PACK</h1>
      <p>The most widely adopted nonprofit technology on Salesforce. 843 Apex classes, 26 triggers, 65 custom objects. NPSP transforms Salesforce into a purpose-built nonprofit CRM for donations, constituent management, recurring giving, and fundraising analytics.</p>
      <div class="galaxy-subtitle">CLICK A PLANET TO EXPLORE &middot; PRESS / TO SEARCH &middot; DRAG TO REARRANGE</div>
    </div>
    <div class="galaxy-stats">
      <div class="stat-item"><div class="stat-value" id="statClasses">843</div><div class="stat-label">Apex Classes</div></div>
      <div class="stat-item"><div class="stat-value" id="statTriggers">26</div><div class="stat-label">Triggers</div></div>
      <div class="stat-item"><div class="stat-value" id="statObjects">65</div><div class="stat-label">Custom Objects</div></div>
      <div class="stat-item"><div class="stat-value" id="statDomains">18</div><div class="stat-label">Domains</div></div>
      <div class="stat-item"><div class="stat-value" id="statComponents">55</div><div class="stat-label">Components</div></div>
    </div>
  </div>

  <!-- PLANET VIEW -->
  <div id="planet-view" class="view-layer">
    <div class="planet-content" id="planet-content"></div>
  </div>

  <!-- CORE VIEW -->
  <div id="core-view" class="view-layer">
    <div class="core-content" id="core-content"></div>
  </div>
</div>

<!-- Help hint -->
<div class="help-hint" aria-hidden="true">
  <kbd>/</kbd> search &middot; <kbd>ESC</kbd> back &middot; Drag planets &middot; Scroll to zoom
</div>

<!-- Scripts: data first, then systems, then integration -->
<script src="js/npsp-data.js"></script>
<script src="js/starfield.js"></script>
<script src="js/physics.js"></script>
<script src="js/renderer.js"></script>
<script src="js/particles.js"></script>
<script src="js/navigation.js"></script>
<script src="js/search.js"></script>
<script src="js/main.js"></script>
</body>
</html>
